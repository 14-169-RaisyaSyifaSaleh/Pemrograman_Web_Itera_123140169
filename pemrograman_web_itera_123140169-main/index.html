<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Daftar Tugas Kuliah • MyTask</title>
    <style>
      :root {
        --bg: #f4f7fb;
        --card: #ffffff;
        --accent: #4f46e5;
        --muted: #6b7280;
        --success: #10b981;
        --danger: #ef4444;
        --glass: rgba(255, 255, 255, 0.7);
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        background: linear-gradient(180deg, #eef2ff 0%, var(--bg) 100%);
        min-height: 100vh;
        color: #111827;
        padding: 28px;
        -webkit-font-smoothing: antialiased;
      }

      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 20px;
        margin-bottom: 18px;
      }
      header h1 {
        margin: 0;
        font-size: 20px;
        display: flex;
        gap: 10px;
        align-items: center;
      }
      header .brand-emoji {
        font-size: 22px;
      }

      main {
        display: grid;
        grid-template-columns: 360px 1fr;
        gap: 20px;
        align-items: start;
      }

      /* panel kiri: form + filter */
      .panel {
        background: var(--card);
        padding: 16px;
        border-radius: 12px;
        box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
      }
      .panel h2 {
        margin: 0 0 12px 0;
        font-size: 16px;
      }

      .field {
        display: flex;
        flex-direction: column;
        gap: 6px;
        margin-bottom: 10px;
      }
      .field input,
      .field select,
      .field textarea {
        padding: 10px 12px;
        border: 1px solid #e6e9ef;
        border-radius: 8px;
        font-size: 14px;
        outline: none;
        background: transparent;
      }
      .row {
        display: flex;
        gap: 8px;
      }
      .btn {
        background: var(--accent);
        color: white;
        padding: 10px 12px;
        border-radius: 10px;
        border: none;
        cursor: pointer;
        font-weight: 600;
      }
      .btn.ghost {
        background: transparent;
        color: var(--muted);
        border: 1px solid #e6e9ef;
      }

      /* panel kanan: list */
      .controls {
        display: flex;
        gap: 12px;
        align-items: center;
        margin-bottom: 12px;
      }
      .search {
        flex: 1;
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .search input {
        width: 100%;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid #e6e9ef;
      }

      .stats {
        display: flex;
        gap: 12px;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }

      .list {
        display: grid;
        gap: 10px;
      }

      .task-card {
        background: var(--card);
        padding: 12px;
        border-radius: 10px;
        display: flex;
        gap: 12px;
        align-items: center;
        border-left: 6px solid transparent;
      }
      .task-card .meta {
        flex: 1;
      }
      .task-title {
        margin: 0;
        font-size: 15px;
        display: flex;
        justify-content: space-between;
        gap: 10px;
        align-items: center;
      }
      .task-course {
        font-size: 13px;
        color: var(--muted);
        margin-top: 6px;
      }
      .task-deadline {
        font-size: 13px;
        margin-top: 6px;
        color: var(--muted);
        display: flex;
        gap: 8px;
        align-items: center;
      }

      .pill {
        padding: 6px 8px;
        border-radius: 999px;
        font-size: 12px;
        font-weight: 600;
      }
      .priority-low {
        background: #f0fdf4;
        color: #065f46;
      }
      .priority-med {
        background: #fffbeb;
        color: #92400e;
      }
      .priority-high {
        background: #fff1f2;
        color: #7f1d1d;
      }

      .actions {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .icon-btn {
        background: transparent;
        border: 0;
        cursor: pointer;
        padding: 6px;
        border-radius: 8px;
      }
      .done {
        color: var(--success);
        font-weight: 700;
      }
      .overdue {
        color: var(--danger);
        font-weight: 700;
      }

      footer {
        margin-top: 18px;
        color: var(--muted);
        font-size: 13px;
      }

      /* responsive */
      @media (max-width: 900px) {
        main {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1><span class="brand-emoji">🎒</span> Daftar Tugas Kuliah</h1>
      <div class="stats" aria-live="polite">
        <div id="totalCounter">Tugas: 0</div>
        <div id="pendingCounter">Belum selesai: 0</div>
      </div>
    </header>

    <main>
      <!-- kiri: tambah & filter -->
      <section class="panel" aria-labelledby="add-heading">
        <h2 id="add-heading">Tambah Tugas Baru</h2>

        <div class="field">
          <label for="titleInput">Judul tugas</label>
          <input
            id="titleInput"
            type="text"
            placeholder="Contoh: Laporan Praktikum Jaringan"
          />
        </div>

        <div class="field">
          <label for="subjectInput">Mata Kuliah</label>
          <input
            id="subjectInput"
            type="text"
            placeholder="Contoh: Jaringan Komputer"
          />
        </div>

        <div class="row">
          <div class="field" style="flex: 1">
            <label for="dueInput">Batas waktu</label>
            <input id="dueInput" type="date" />
          </div>
          <div class="field" style="width: 120px">
            <label for="prioritySelect">Prioritas</label>
            <select id="prioritySelect">
              <option value="low">Rendah</option>
              <option value="medium" selected>Sedang</option>
              <option value="high">Tinggi</option>
            </select>
          </div>
        </div>

        <div class="row" style="margin-top: 8px">
          <button id="addBtn" class="btn">Tambah Tugas</button>
          <button id="clearBtn" class="btn ghost" title="Kosongkan form">
            Reset
          </button>
        </div>

        <hr
          style="margin: 14px 0; border: none; border-top: 1px solid #eef2f7"
        />

        <h2 style="font-size: 15px; margin-bottom: 10px">Filter & Cari</h2>
        <div class="field">
          <label for="statusFilter">Status</label>
          <select id="statusFilter">
            <option value="all">Semua</option>
            <option value="active">Belum Selesai</option>
            <option value="done">Selesai</option>
          </select>
        </div>

        <div class="field">
          <label for="subjectFilter">Mata kuliah (kata kunci)</label>
          <input
            id="subjectFilter"
            type="text"
            placeholder="Ketikan untuk memfilter..."
          />
        </div>

        <div class="field">
          <label for="sortSelect">Urutkan</label>
          <select id="sortSelect">
            <option value="byDate">Terdekat</option>
            <option value="byPriority">Prioritas</option>
            <option value="byCourse">Mata kuliah A→Z</option>
          </select>
        </div>
      </section>

      <!-- kanan: list -->
      <section>
        <div
          style="
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
          "
        >
          <div class="search">
            <input
              id="quickSearch"
              type="search"
              placeholder="Cari judul atau mata kuliah..."
            />
          </div>
          <div>
            <button id="exportBtn" class="btn ghost" title="Download JSON">
              Export
            </button>
            <button
              id="importBtn"
              class="btn"
              title="Import demo"
              style="margin-left: 6px"
            >
              Isi Cepat
            </button>
          </div>
        </div>

        <div id="taskList" class="list" aria-live="polite">
          <!-- task cards here -->
        </div>

        <footer>
          Tip: Tandai tugas selesai setelah submit. Gunakan export untuk
          cadangan.
        </footer>
      </section>
    </main>

    <!-- Edit modal sederhana (floating) -->
    <div
      id="editOverlay"
      style="
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(2, 6, 23, 0.5);
        z-index: 60;
      "
    >
      <div
        style="
          background: var(--card);
          padding: 16px;
          border-radius: 12px;
          max-width: 420px;
          width: 92%;
          box-shadow: 0 14px 30px rgba(2, 6, 23, 0.3);
        "
      >
        <h3 style="margin-top: 0">Ubah Tugas</h3>
        <div style="display: flex; flex-direction: column; gap: 8px">
          <input id="editTitle" placeholder="Judul" />
          <input id="editSubject" placeholder="Mata kuliah" />
          <input id="editDue" type="date" />
          <select id="editPriority">
            <option value="low">Rendah</option>
            <option value="medium">Sedang</option>
            <option value="high">Tinggi</option>
          </select>
          <div
            style="
              display: flex;
              gap: 8px;
              justify-content: flex-end;
              margin-top: 6px;
            "
          >
            <button id="cancelEditBtn" class="btn ghost">Batal</button>
            <button id="saveEditBtn" class="btn">Simpan</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Simple task manager (localStorage)
      const $ = (sel) => document.querySelector(sel);
      const $$ = (sel) => document.querySelectorAll(sel);

      // elements
      const titleInput = $("#titleInput");
      const subjectInput = $("#subjectInput");
      const dueInput = $("#dueInput");
      const prioritySelect = $("#prioritySelect");
      const addBtn = $("#addBtn");
      const clearBtn = $("#clearBtn");

      const statusFilter = $("#statusFilter");
      const subjectFilter = $("#subjectFilter");
      const sortSelect = $("#sortSelect");
      const quickSearch = $("#quickSearch");

      const taskList = $("#taskList");
      const totalCounter = $("#totalCounter");
      const pendingCounter = $("#pendingCounter");

      const exportBtn = $("#exportBtn");
      const importBtn = $("#importBtn");

      const editOverlay = $("#editOverlay");
      const editTitle = $("#editTitle");
      const editSubject = $("#editSubject");
      const editDue = $("#editDue");
      const editPriority = $("#editPriority");
      const cancelEditBtn = $("#cancelEditBtn");
      const saveEditBtn = $("#saveEditBtn");

      let tasks = JSON.parse(localStorage.getItem("myTasks_v2") || "[]");
      let editingId = null;

      function uid() {
        return "t_" + Math.random().toString(36).slice(2, 9);
      }

      function save() {
        localStorage.setItem("myTasks_v2", JSON.stringify(tasks));
        render();
      }

      function addTask() {
        const title = titleInput.value.trim();
        const subject = subjectInput.value.trim();
        const due = dueInput.value;
        const priority = prioritySelect.value;
        if (!title || !subject || !due) {
          alert("Isi semua field (judul, mata kuliah, tanggal).");
          return;
        }
        tasks.push({
          id: uid(),
          title,
          subject,
          due,
          priority,
          done: false,
          createdAt: new Date().toISOString(),
        });
        titleInput.value = "";
        subjectInput.value = "";
        dueInput.value = "";
        prioritySelect.value = "medium";
        save();
      }

      function deleteTask(id) {
        if (!confirm("Hapus tugas ini?")) return;
        tasks = tasks.filter((t) => t.id !== id);
        save();
      }

      function toggleDone(id) {
        const t = tasks.find((x) => x.id === id);
        if (t) t.done = !t.done;
        save();
      }

      function openEdit(id) {
        const t = tasks.find((x) => x.id === id);
        if (!t) return;
        editingId = id;
        editTitle.value = t.title;
        editSubject.value = t.subject;
        editDue.value = t.due;
        editPriority.value = t.priority;
        editOverlay.style.display = "flex";
      }

      function saveEdit() {
        if (!editingId) return;
        const t = tasks.find((x) => x.id === editingId);
        if (!t) return;
        if (
          !editTitle.value.trim() ||
          !editSubject.value.trim() ||
          !editDue.value
        ) {
          alert("Lengkapi data perubahan.");
          return;
        }
        t.title = editTitle.value.trim();
        t.subject = editSubject.value.trim();
        t.due = editDue.value;
        t.priority = editPriority.value;
        editingId = null;
        editOverlay.style.display = "none";
        save();
      }

      cancelEditBtn.addEventListener("click", () => {
        editingId = null;
        editOverlay.style.display = "none";
      });
      saveEditBtn.addEventListener("click", saveEdit);

      function getFilteredSorted() {
        const st = statusFilter.value;
        const subKey = subjectFilter.value.trim().toLowerCase();
        const q = quickSearch.value.trim().toLowerCase();
        let list = tasks.slice();

        // filters
        if (st === "active") list = list.filter((t) => !t.done);
        if (st === "done") list = list.filter((t) => t.done);
        if (subKey)
          list = list.filter((t) => t.subject.toLowerCase().includes(subKey));
        if (q)
          list = list.filter(
            (t) =>
              t.title.toLowerCase().includes(q) ||
              t.subject.toLowerCase().includes(q)
          );

        // sort
        if (sortSelect.value === "byDate") {
          list.sort((a, b) => new Date(a.due) - new Date(b.due));
        } else if (sortSelect.value === "byPriority") {
          const order = { high: 0, medium: 1, low: 2 };
          list.sort((a, b) => order[a.priority] - order[b.priority]);
        } else if (sortSelect.value === "byCourse") {
          list.sort((a, b) => a.subject.localeCompare(b.subject));
        }
        return list;
      }

      function dueLabel(dueISO) {
        const today = new Date();
        const due = new Date(dueISO + "T23:59:59");
        const diff = Math.floor(
          (due -
            new Date(today.getFullYear(), today.getMonth(), today.getDate())) /
            (1000 * 60 * 60 * 24)
        );
        if (diff < 0)
          return {
            text: "Lewat " + Math.abs(diff) + " hari",
            state: "overdue",
          };
        if (diff === 0) return { text: "Hari ini", state: "today" };
        if (diff === 1) return { text: "Besok", state: "soon" };
        return { text: due.toLocaleDateString("id-ID"), state: "normal" };
      }

      function render() {
        const list = getFilteredSorted();
        taskList.innerHTML = "";
        list.forEach((t) => {
          const dl = dueLabel(t.due);
          const card = document.createElement("article");
          card.className = "task-card";
          // border color by priority
          const borderColor =
            t.priority === "high"
              ? "#fee2e2"
              : t.priority === "medium"
              ? "#fffbeb"
              : "#ecfdf5";
          card.style.borderLeftColor =
            t.priority === "high"
              ? "#ef4444"
              : t.priority === "medium"
              ? "#f59e0b"
              : "#10b981";

          const meta = document.createElement("div");
          meta.className = "meta";

          const titleRow = document.createElement("div");
          titleRow.className = "task-title";

          const h = document.createElement("h3");
          h.textContent = t.title;
          h.style.margin = 0;
          h.style.fontSize = "15px";
          if (t.done) h.style.textDecoration = "line-through";

          const smallPill = document.createElement("span");
          smallPill.className =
            "pill " +
            (t.priority === "high"
              ? "priority-high"
              : t.priority === "medium"
              ? "priority-med"
              : "priority-low");
          smallPill.textContent =
            t.priority === "high"
              ? "Tinggi"
              : t.priority === "medium"
              ? "Sedang"
              : "Rendah";

          titleRow.appendChild(h);
          titleRow.appendChild(smallPill);

          const course = document.createElement("div");
          course.className = "task-course";
          course.textContent = t.subject;

          const dlDiv = document.createElement("div");
          dlDiv.className = "task-deadline";
          const dlIcon = document.createElement("span");
          dlIcon.textContent = "⏰";
          const dlText = document.createElement("span");
          dlText.textContent = dl.text;
          if (dl.state === "overdue") dlText.className = "overdue";
          if (t.done) dlText.className = "done";

          dlDiv.appendChild(dlIcon);
          dlDiv.appendChild(dlText);

          meta.appendChild(titleRow);
          meta.appendChild(course);
          meta.appendChild(dlDiv);

          const actions = document.createElement("div");
          actions.className = "actions";

          const doneBtn = document.createElement("button");
          doneBtn.className = "icon-btn";
          doneBtn.title = t.done ? "Tandai belum selesai" : "Tandai selesai";
          doneBtn.innerHTML = t.done ? "↺" : "✓";
          doneBtn.addEventListener("click", () => toggleDone(t.id));

          const editBtn = document.createElement("button");
          editBtn.className = "icon-btn";
          editBtn.title = "Ubah";
          editBtn.innerHTML = "✎";
          editBtn.addEventListener("click", () => openEdit(t.id));

          const delBtn = document.createElement("button");
          delBtn.className = "icon-btn";
          delBtn.title = "Hapus";
          delBtn.innerHTML = "🗑";
          delBtn.addEventListener("click", () => deleteTask(t.id));

          actions.appendChild(doneBtn);
          actions.appendChild(editBtn);
          actions.appendChild(delBtn);

          card.appendChild(meta);
          card.appendChild(actions);

          taskList.appendChild(card);
        });

        totalCounter.textContent = "Tugas: " + tasks.length;
        pendingCounter.textContent =
          "Belum selesai: " + tasks.filter((t) => !t.done).length;
      }

      // event wiring
      addBtn.addEventListener("click", addTask);
      clearBtn.addEventListener("click", () => {
        titleInput.value = "";
        subjectInput.value = "";
        dueInput.value = "";
        prioritySelect.value = "medium";
      });

      [statusFilter, subjectFilter, sortSelect, quickSearch].forEach((el) => {
        el.addEventListener("input", render);
        el.addEventListener("change", render);
      });

      exportBtn.addEventListener("click", () => {
        const data = JSON.stringify(tasks, null, 2);
        const blob = new Blob([data], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "tugas-export.json";
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });

      // import sample quick-fill
      importBtn.addEventListener("click", () => {
        const sample = [
          {
            id: uid(),
            title: "Proposal KP",
            subject: "Manajemen Proyek",
            due: new Date(Date.now() + 2 * 24 * 3600 * 1000)
              .toISOString()
              .slice(0, 10),
            priority: "high",
            done: false,
            createdAt: new Date().toISOString(),
          },
          {
            id: uid(),
            title: "Tugas Pemrograman",
            subject: "Algoritma",
            due: new Date(Date.now() + 5 * 24 * 3600 * 1000)
              .toISOString()
              .slice(0, 10),
            priority: "medium",
            done: false,
            createdAt: new Date().toISOString(),
          },
          {
            id: uid(),
            title: "Presentasi",
            subject: "Kewirausahaan",
            due: new Date(Date.now() + 1 * 24 * 3600 * 1000)
              .toISOString()
              .slice(0, 10),
            priority: "low",
            done: false,
            createdAt: new Date().toISOString(),
          },
        ];
        tasks = tasks.concat(sample);
        save();
      });

      // initial render
      render();

      // keyboard: enter to add when in inputs
      [titleInput, subjectInput, dueInput].forEach((inp) => {
        inp.addEventListener("keydown", (e) => {
          if (e.key === "Enter") addTask();
        });
      });
    </script>
  </body>
</html>
